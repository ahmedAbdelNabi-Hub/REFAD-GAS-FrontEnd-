<div class="">
    <!-- Loading State -->
    @if (isLoading()) {
    <div class="flex justify-center items-center mt-4 py-20">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#00853e]"></div>
    </div>
    }
    @else {
    <div class="flex flex-col gap-4">
        <div class="flex items-center justify-between mb-9 mt-8 px-2">
            <div class="flex items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold">{{ company()?.companyNameArabic }}</h1>
                </div>
            </div>
        </div>

        <div class="w-full mx-auto">
            <nav class="flex flex-wrap   mb-6 border-b border-gray-200">
                <button type="button"
                    class="tab-btn text-[#667085] font-extrabold flex gap-2 items-center justify-center px-2 py-2 text-[16px] rounded-t-lg focus:outline-none group"
                    [class.data-active]="activeTab() === 'company'" (click)="setActiveTab('company')">
                    <i class='bx bx-home mr-2 text-lg'></i>
                    <span>بيانات الشركة</span>
                </button>

                <!-- Cars Tab -->
                <button type="button"
                    class="tab-btn text-[#667085] font-extrabold flex gap-2 items-center justify-center px-2 py-2 text-[16px] rounded-t-lg focus:outline-none group"
                    [class.data-active]="activeTab() === 'cars'" (click)="setActiveTab('cars')">
                    <i class='bx bx-car mr-2 text-lg'></i>
                    <span> سيارات الشركه</span>
                </button>

                <!-- Payment Tab -->
                <button type="button"
                    class="tab-btn text-[#667085] font-extrabold flex gap-2 items-center justify-center px-2 py-2 text-[16px]rounded-t-lg focus:outline-none group"
                    [class.data-active]="activeTab() === 'payment'" (click)="setActiveTab('payment')">
                    <i class='bx bx-credit-card mr-2 text-lg'></i>
                    <span>الدفع</span>
                </button>

                <!-- Statistics Tab -->
                <button type="button"
                    class="tab-btn text-[#667085] font-extrabold flex gap-2 items-center justify-center px-2 py-2 text-[16px] rounded-t-lg focus:outline-none group"
                    [class.data-active]="activeTab() === 'statistics'" (click)="setActiveTab('statistics')">
                    <i class='bx bx-bar-chart-alt-2 mr-2 text-lg'></i>
                    <span>الإحصائيات</span>
                </button>
            </nav>
        </div>
@if (activeTab() === 'company') {
<!-- Company Data Content -->
<div class="hidden grid-cols-1 md:grid-cols-6 gap-5 px-2 py-6  md:grid">
    <!-- LOGO - Always visible, responsive size -->
    <div *ngIf="company()?.logoPath;" 
         class="flex flex-col col-span-1 items-center justify-center">
        <span *ngIf="company()?.logoPath;"
              class="flex items-center justify-center 
                     w-20 h-20 sm:w-24 sm:h-24 md:w-36 md:h-36 
                     rounded-full bg-[#667085]">
            <span class="font-medium text-[12px] sm:text-sm md:text-base text-white">
                {{ company()?.companyNameArabic?.charAt(0) }}
            </span>
        </span>
    </div>

    <!-- LEFT COLUMN 1 - Labels (Arabic Company Info) -->
    <div class="flex font-semibold text-[#4b515d] text-xs col-span-1 flex-col gap-3 md:gap-6">
        <span class="text-right">اسم الشركة (عربي)</span>
        <span class="text-right">اسم الشركة (إنجليزي)</span>
        <span class="text-right">الشخص المسؤول</span>
        <span class="text-right">رقم الهوية</span>
        <span class="text-right">رقم الجوال</span>
        <span class="text-right">البريد الإلكتروني</span>
        <span class="text-right">ر.س / سيارة</span>
    </div>

    <!-- LEFT COLUMN 2 - Values (Arabic Company Info) -->
    <div class="flex col-span-1 flex-col gap-3 md:gap-6 text-gray-900 font-semibold text-xs">
        <span class="text-right">{{ company()?.companyNameArabic || '-' }}</span>
        <span class="text-right">{{ company()?.companyNameEnglish || '-' }}</span>
        <span class="text-right">{{ company()?.responsiblePerson || '-' }}</span>
        <span class="text-right">{{ company()?.identityId || '-' }}</span>
        <span class="text-right">{{ company()?.mobile || '-' }}</span>
        <span class="text-right">{{ company()?.email || '-' }}</span>
        <span class="text-right">{{ company()?.monthlyCostPerCar || '-' }}</span>
    </div>

    <!-- RIGHT COLUMN 1 - Labels (Address & Other Info) -->
    <div class="flex font-semibold text-[#4b515d] text-xs col-span-1 flex-col gap-3 md:gap-6">
        <span class="text-right">العنوان</span>
        <span class="text-right">نوع الحد للسيارات</span>
        <span class="text-right">عدد حدود السيارات</span>
        <span class="text-right">الحالة</span>
        <span class="text-right">صورة المضخة</span>
        <span class="text-right">صورة السيارة</span>
        <span class="text-right">تاريخ الإنشاء</span>
    </div>

    <!-- RIGHT COLUMN 2 - Values (Address & Other Info) -->
    <div class="flex col-span-1 flex-col gap-3 md:gap-6 text-gray-900 font-semibold text-xs">
        <span class="text-right">{{ company()?.address || '-' }}</span>
        <span class="text-right">
            {{
            company()?.carLimitType === 'daily'
            ? 'يومي'
            : company()?.carLimitType === 'weekly'
            ? 'أسبوعي'
            : 'شهري'
            }}
        </span>
        <span class="text-right">{{ company()?.carLimitCount || 0 }}</span>
        <span class="text-right py-1 px-1.5 inline-flex max-w-[70px] items-center gap-x-1 text-xs font-medium rounded-full {{ getStatusClass(company()?.status!) }}">
            <svg class="size-2.5" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
            </svg>
            {{ getStatusLabel(company()?.status!) }}
        </span>
        <span class="text-right">{{ company()?.pumpImageRequired ? 'مطلوب' : 'غير مطلوب' }}</span>
        <span class="text-right">{{ company()?.carImageRequired ? 'مطلوب' : 'غير مطلوب' }}</span>
        <span class="text-right">{{ company()?.createdAt | date: 'dd/MM/yyyy - hh:mm a' }}</span>
    </div>
</div>

<!-- MOBILE CARDS VERSION (Hidden on md+) -->
<div class="md:hidden space-y-6 px-2 pb-6">
    <!-- Company Header Card -->
    <div class="bg-white rounded-sm  border border-gray-200 p-4">
        <div class="flex items-center gap-4 mb-4">
            <div *ngIf="company()?.logoPath;" class="flex-shrink-0">
                <span class="flex items-center justify-center w-16 h-16 rounded-full bg-[#667085]">
                    <span class="font-medium text-sm text-white">
                        {{ company()?.companyNameArabic?.charAt(0) }}
                    </span>
                </span>
            </div>
            <div class="flex-1 min-w-0">
                <h3 class="font-semibold text-gray-900 text-base rtl">
                    {{ company()?.companyNameArabic || '-' }}
                </h3>
                <p class="text-gray-600 text-sm rtl">{{ company()?.companyNameEnglish || '-' }}</p>
            </div>
        </div>

        <!-- Key Info Grid -->
        <div class="grid grid-cols-2 gap-3 text-xs">
            <div class="space-y-2">
                <span class="text-[#4b515d] block rtl">الشخص المسؤول</span>
                <span class="font-semibold text-gray-900 rtl">{{ company()?.responsiblePerson || '-' }}</span>
                
                <span class="text-[#4b515d] block rtl">رقم الهوية</span>
                <span class="font-semibold text-gray-900 rtl">{{ company()?.identityId || '-' }}</span>
                
                <span class="text-[#4b515d] block rtl">رقم الجوال</span>
                <span class="font-semibold text-gray-900 rtl">{{ company()?.mobile || '-' }}</span>
            </div>
            <div class="space-y-2">
                <span class="text-[#4b515d] block rtl">البريد الإلكتروني</span>
                <span class="font-semibold text-gray-900 rtl">{{ company()?.email || '-' }}</span>
                
                <span class="text-[#4b515d] block rtl">ر.س / سيارة</span>
                <span class="font-semibold text-gray-900 rtl">{{ company()?.monthlyCostPerCar || '-' }}</span>
                
                <span class="text-[#4b515d] block rtl">العنوان</span>
                <span class="font-semibold text-gray-900 rtl max-w-full truncate">{{ company()?.address || '-' }}</span>
            </div>
        </div>
    </div>

    <!-- Limits & Status Card -->
    <div class="bg-white rounded-sm  border border-gray-200 p-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="space-y-3">
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">نوع الحد للسيارات</span>
                    <span class="font-semibold text-gray-900">
                        {{
                        company()?.carLimitType === 'daily'
                        ? 'يومي'
                        : company()?.carLimitType === 'weekly'
                        ? 'أسبوعي'
                        : 'شهري'
                        }}
                    </span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">عدد حدود السيارات</span>
                    <span class="font-semibold text-gray-900">{{ company()?.carLimitCount || 0 }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">الحالة</span>
                    <span class="py-1 px-2 inline-flex items-center gap-1 text-xs font-medium rounded-full {{ getStatusClass(company()?.status!) }}">
                        <svg class="size-2" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                        </svg>
                        {{ getStatusLabel(company()?.status!) }}
                    </span>
                </div>
            </div>
            <div class="space-y-3">
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">صورة المضخة</span>
                    <span class="font-semibold text-gray-900">{{ company()?.pumpImageRequired ? 'مطلوب' : 'غير مطلوب' }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">صورة السيارة</span>
                    <span class="font-semibold text-gray-900">{{ company()?.carImageRequired ? 'مطلوب' : 'غير مطلوب' }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-[#4b515d] rtl">تاريخ الإنشاء</span>
                    <span class="font-semibold text-gray-900">{{ company()?.createdAt | date: 'dd/MM/yyyy - hh:mm a' }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Action Buttons - Fully Responsive -->
<div class="flex flex-col sm:flex-row gap-3 mt-6 px-2 md:px-0 justify-end">
    <!-- Edit Button -->
    <button routerLink="/admin/customer/edit/{{ company()?.id }}"
            class="bg-[#ffffff] text-[#667085] cursor-pointer px-4 py-2.5 rounded-md 
                   flex items-center justify-center gap-2 transition-all border border-gray-200 
                   font-medium text-xs w-full sm:w-auto hover:shadow-md">
        <i class='bx bx-edit text-lg'></i>
        <span>تعديل بيانات العميل</span>
    </button>

    <!-- Close Button -->
    <button (click)="goBack()"
            class="bg-gray-100 text-[#667085] hover:bg-gray-200 border border-gray-200 
                   cursor-pointer px-4 py-2.5 rounded-md flex items-center justify-center 
                   gap-2 transition-all font-medium text-xs w-full sm:w-auto hover:shadow-md">
        <i class='bx bx-x text-lg'></i>
        <span>إغلاق</span>
    </button>
</div>
}

        @if (activeTab() === 'cars') {
        <app-cars [companyId]="company()?.id!"></app-cars>
        }

        @if (activeTab() === 'payment') {
        <div class="px-2 py-6">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <h2 class="text-lg font-bold text-[#00853e] mb-4">الدفع</h2>
                <p class="text-gray-500">محتوى الدفع سيتم إضافته هنا</p>
            </div>
        </div>
        }

        @if (activeTab() === 'statistics') {
        <!-- Statistics Content -->
        <div class="px-2 py-6">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <h2 class="text-lg font-bold text-[#00853e] mb-4">الإحصائيات</h2>
                <p class="text-gray-500">محتوى الإحصائيات سيتم إضافته هنا</p>
                <!-- Add your statistics charts/content here -->
            </div>
        </div>
        }
    </div>
    }
</div>